<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.dbp.naemom.dao.OrderDAO">
  	<select id="selectProduct" resultType="kr.dbp.naemom.vo.ProductVO">
  		select * from product where pd_num = #{pd_num}
  	</select>
  	<select id="selectTravelOption" resultType="kr.dbp.naemom.vo.Option_landMarkVO">
  		select * from landmark_option where lo_pd_num = #{pd_num}
  	</select>
  	<select id="selectFoodOption" resultType="kr.dbp.naemom.vo.Option_restrauntVO">
  		select * from restraunt_option where reo_pd_num = #{pd_num}
  	</select>
  	<select id="selectHomeOption" resultType="kr.dbp.naemom.vo.Option_accomodationVO">
  		select * from accomodation_option 
  			where ao_pd_num = #{pd_num}
  			order by ao_name asc
  	</select>
  	<select id="selectFestivalOption" resultType="kr.dbp.naemom.vo.Option_festivalVO">
  		select * from festival_option where fo_pd_num = #{pd_num}
  	</select>
  	<select id="selectFileByPdNum" resultType="kr.dbp.naemom.vo.FileVO">
  		select * from file where fi_table_key = #{fi_table_key} and fi_category like concat('%',#{fi_category},'%') 
  			and fi_table = #{fi_table}
  	</select>
  	<insert id="insertBasket">
  		insert into shopping_basket(sb_me_id,sb_amount,sb_table,sb_table_key,sb_price, sb_date)
  		values(#{me_id},#{tmp.pr_amount},#{tmp.pr_category},#{tmp.pr_option_num},#{tmp.pr_price}, #{tmp.pr_date})
  	</insert>
  	<resultMap type="kr.dbp.naemom.vo.Shopping_basketVO" id="selectBasketByOption">
  		<id property="sb_num" column="sb_num"/>
  		<result property="sb_me_id" column="sb_me_id"/>
  		<result property="sb_amount" column="sb_amount"/>
  		<result property="sb_table" column="sb_table"/>
  		<result property="sb_table_key" column="sb_table_key"/>
  		<result property="sb_price" column="sb_price"/>
  		<collection property="travel" ofType="kr.dbp.naemom.vo.Option_landMarkVO" column="{sb_table=sb_table, sb_table_key=sb_table_key}" select="selectTravelListByKey"></collection>
  		<collection property="food" ofType="kr.dbp.naemom.vo.Option_restrauntVO" column="{sb_table=sb_table, sb_table_key=sb_table_key}" select="selectFoodListByKey"></collection>
  		<collection property="home" ofType="kr.dbp.naemom.vo.Option_accomodationVO" column="{sb_table=sb_table, sb_table_key=sb_table_key}" select="selectHomeListByKey"></collection>
  		<collection property="festival" ofType="kr.dbp.naemom.vo.Option_festivalVO" column="{sb_table=sb_table, sb_table_key=sb_table_key}" select="selectFestivalListByKey"></collection>
  	</resultMap>
  	<select id="selectBasket" resultMap="selectBasketByOption">
  		select * from shopping_basket where sb_me_id = #{me_id}
   	</select>
   	<select id="selectTravelListByKey" resultType="kr.dbp.naemom.vo.Option_landMarkVO" parameterType="java.util.Map">
   		select * from landMark_option where lo_num =  #{sb_table_key} and #{sb_table} = 'landmark_option'
   	</select>
   	<select id="selectFoodListByKey" resultType="kr.dbp.naemom.vo.Option_restrauntVO" parameterType="java.util.Map">
   		select * from restraunt_option where reo_num = #{sb_table_key} and #{sb_table} = 'restraunt_option'
   	</select>
   	<select id="selectHomeListByKey" resultType="kr.dbp.naemom.vo.Option_accomodationVO" parameterType="java.util.Map">
   		select * from accomodation_option where ao_num = #{sb_table_key} and #{sb_table} = 'accomodation_option'
   	</select>
   	<select id="selectFestivalListByKey" resultType="kr.dbp.naemom.vo.Option_festivalVO" parameterType="java.util.Map">
   		select * from festival_option where fo_num = #{sb_table_key} and #{sb_table} = 'festival_option'
   	</select>
   	
   	
   	
   	
   	<!-- <select id="selectFestivalByNum" resultType="kr.dbp.naemom.vo.Option_festivalVO">
   		select * from festival_option where fo_num = #{sb_table_key}
   	</select>
   	<select id="selectHomeByNum" resultType="kr.dbp.naemom.vo.Option_accomodationVO">
   		select * from accomodation_option where ao_num = #{sb_table_key}
   	</select>
   	<select id="selectFoodByNum" resultType="kr.dbp.naemom.vo.Option_restrauntVO">
   		select * from restraunt_option where reo_num = #{sb_table_key}
   	</select>
   	<select id="selectTravelByNum" resultType="kr.dbp.naemom.vo.Option_landMarkVO">
   		select * from landMark_option where lo_num =  #{sb_table_key}
   	</select> -->
</mapper>















